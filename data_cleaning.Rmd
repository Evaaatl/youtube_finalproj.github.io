---
title: "Data cleaning"
output: html_document
---

```{r}
library(dplyr)
library(tidyr)
library(tidyverse)
library(leaflet)
library(ggplot2)

# Import dataset
df <-
  read_csv("Data/Global YouTube Statistics.csv") |>
  janitor::clean_names()

# Check variable names 
variable_names <- names(df)
print(variable_names)

cleaned_df <- df |>
  select(-youtuber,-title,-video_views_rank, -country_rank,-channel_type_rank, -created_month, -created_date, -gross_tertiary_education_enrollment_percent, -unemployment_rate, -urban_population) |> 
  rename(id = rank)

head(cleaned_df, 10)

# Save as a new dataset
write_csv(cleaned_df, path = "./Data/cleaned_youtube_df.csv")

read_csv("Data/cleaned_youtube_df.csv")

```

```{r}
table(cleaned_df$category)
table(cleaned_df$channel_type)
```

```{r}
table(cleaned_df$country)
```



```{r}
channel_counts <- cleaned_df%>% 
  group_by(country, longitude, latitude) %>% 
  summarise(channel_count = n())

world_map <- leaflet() %>%
  addTiles() %>%  # Add a tile layer (you can customize the tile layer if needed)
  addMarkers(
    data = channel_counts,
    ~longitude, ~latitude,  # Specify the longitude and latitude columns
    label = ~paste(country, ": ", channel_count, " channels"),
    popup = TRUE
  )

# Show the map
world_map
```

